<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Earn Rewards</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<script src="//libtl.com/sdk.js" data-zone="9687002" data-sdk="show_9687002"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<style>
  body { margin:0; font-family: system-ui, sans-serif; background:#f5f7fa; padding-bottom:80px; }
  .header {
    background:#2ecc71; color:white; padding:15px;
    display:flex; align-items:center; gap:10px;
  }
  .avatar { width:40px; height:40px; border-radius:50%; background:#ddd; }
  .userinfo { flex:1; }
  .username { font-weight:600; font-size:1rem; }
  .balance { font-size:0.9rem; }
  h2 { color:#2ecc71; margin:20px 0 10px; text-align:center; }

  .card {
    background:white; margin:10px auto; padding:15px;
    border-radius:12px; max-width:400px;
    box-shadow:0 2px 6px rgba(0,0,0,0.05);
  }
  .row { display:flex; justify-content:space-between; margin:4px 0; }
  .progress-bar {
    height:10px; background:#e0e0e0; border-radius:5px; overflow:hidden; margin-top:8px;
  }
  .progress { height:100%; background:#2ecc71; width:0%; }
  .btn {
    display:block; width:100%; margin-top:12px; padding:10px;
    background:#1f8ef1; color:white; text-align:center;
    border:none; border-radius:8px; font-size:1rem; cursor:pointer;
  }
  .btn:disabled { background:#999; cursor:not-allowed; }
  
  /* Toast */
  .toast {
    position:fixed; top:20px; right:20px;
    background:#2ecc71; color:white; padding:10px 15px;
    border-radius:8px; box-shadow:0 2px 6px rgba(0,0,0,0.2);
    opacity:0; transform:translateY(-10px);
    transition:opacity 0.3s, transform 0.3s;
    z-index:9999;
  }
  .toast.show {
    opacity:1; transform:translateY(0);
  }

  /* Bottom navigation */
  .bottom-nav {
    position:fixed; bottom:0; left:0; right:0; background:white;
    display:flex; justify-content:space-around; padding:6px 0;
    border-top:1px solid #ddd; box-shadow:0 -2px 6px rgba(0,0,0,0.05);
    z-index:900;
  }
  .nav-item {
    text-align:center; color:#666; font-size:0.8rem; flex:1;
  }
  .nav-item i { font-size:1.4rem; display:block; margin-bottom:2px; }
  .nav-item.active { color:#2ecc71; }

  /* Daily tasks */
  .daily-task {
    display:flex; justify-content:space-between; align-items:center;
    padding:8px 0;
  }
  .join-btn {
    background:white; border:1px solid #2ecc71; color:#2ecc71;
    padding:6px 10px; border-radius:6px; font-size:0.85rem;
    display:flex; align-items:center; gap:4px; text-decoration:none;
  }
  .verify-btn {
    background:#1f8ef1; border:none; color:white;
    padding:6px 10px; border-radius:6px; font-size:0.85rem;
    cursor:pointer;
  }

  /* Refer & Earn fixed button */
  .refer-fixed {
    position:fixed; right:16px; bottom:80px;
    background:#2ecc71; color:white; border:none;
    border-radius:50px; padding:12px 20px;
    display:flex; align-items:center; gap:6px;
    font-size:0.9rem; cursor:pointer;
    box-shadow:0 4px 8px rgba(0,0,0,0.15);
    z-index:950;
  }
  .refer-fixed i {
    font-size:1.2rem;
  }
</style>
</head>
<body>

<div class="header">
  <div class="avatar"></div>
  <div class="userinfo">
    <div class="username">David Wilson</div>
    <div class="balance"><span id="balance">0</span> VET</div>
  </div>
</div>

<h2>Earn Rewards</h2>
<div class="card">
  <div class="row"><span>Total Tasks:</span><span id="total">30</span></div>
  <div class="row"><span>Completed:</span><span id="completed">0</span></div>
  <div class="row"><span>Remaining:</span><span id="remaining">30</span></div>
  <div class="progress-bar"><div class="progress" id="progress"></div></div>
  <button id="watch" class="btn">Start Task</button>
</div>

<h2>Daily Tasks</h2>
<div class="card">
  <div class="daily-task">
    <div>
      <div style="font-weight:600;">Crypto News Channel</div>
      <div style="color:#2ecc71; font-size:0.9rem;">Reward: VET 2.00</div>
    </div>
    <div style="display:flex; gap:6px;">
      <a href="https://t.me/cryptonews" target="_blank" class="join-btn">
        <i class="fa-brands fa-telegram"></i> Join
      </a>
      <button class="verify-btn">Verify</button>
    </div>
  </div>
  <hr>
  <div class="daily-task">
    <div>
      <div style="font-weight:600;">Airdrop Hunters</div>
      <div style="color:#2ecc71; font-size:0.9rem;">Reward: VET 3.00</div>
    </div>
    <div style="display:flex; gap:6px;">
      <a href="https://t.me/airdrophunters" target="_blank" class="join-btn">
        <i class="fa-brands fa-telegram"></i> Join
      </a>
      <button class="verify-btn">Verify</button>
    </div>
  </div>
</div>

<!-- Toast -->
<div id="toast" class="toast">Оплата получена!</div>

<!-- Refer & Earn fixed button -->
<button class="refer-fixed">
  <i class="fa-solid fa-users"></i> Refer & Earn
</button>

<!-- Bottom navigation -->
<div class="bottom-nav">
  <div class="nav-item active"><i class="fa-solid fa-house"></i>Home</div>
  <div class="nav-item"><i class="fa-solid fa-coins"></i>Earn</div>
  <div class="nav-item"><i class="fa-solid fa-wallet"></i>Withdraw</div>
  <div class="nav-item"><i class="fa-solid fa-user"></i>Profile</div>
</div>

<script>
  const maxTasks = 30;
  const rewardPerAd = 2;
  const cooldown = 20 * 1000; // 20 секунд

  let completed = parseInt(getCookie("completed") || 0);
  let balance = parseFloat(getCookie("balance") || 0);
  let lastTime = parseInt(getCookie("lastTime") || 0);

  updateUI();

  document.getElementById("watch").addEventListener("click", () => {
    const now = Date.now();
    if (completed >= maxTasks) {
      alert("Вы достигли лимита на сегодня!");
      return;
    }
    if (now - lastTime < cooldown) {
      alert(`Подождите ${Math.ceil((cooldown - (now - lastTime))/1000)} секунд`);
      return;
    }
    if (typeof window.show_9687002 !== "function") {
      alert("Реклама ещё не загрузилась");
      return;
    }
    show_9687002().then(res => {
      if (res.reward_event_type === "valued") {
        completed++;
        balance += rewardPerAd;
        lastTime = Date.now();
        setCookie("completed", completed, 1);
        setCookie("balance", balance, 1);
        setCookie("lastTime", lastTime, 1);
        updateUI();
        showToast("Оплата получена!");
      }
    }).catch(err => {
      alert("Ошибка показа рекламы");
      console.error(err);
    });
  });

  function updateUI() {
    document.getElementById("completed").textContent = completed;
    document.getElementById("remaining").textContent = maxTasks - completed;
    document.getElementById("balance").textContent = balance.toFixed(2);
    document.getElementById("progress").style.width = (completed / maxTasks * 100) + "%";
  }
  function setCookie(name, value, days) {
    let expires = "";
    if (days) {
      const date = new Date();
      date.setTime(date.getTime() + (days*24*60*60*1000));
      expires = "; expires=" + date.toUTCString();
    }
    document.cookie = name + "=" + (value || "")  + expires + "; path=/";
  }
  function getCookie(name) {
    const nameEQ = name + "=";
    const ca = document.cookie.split(';');
    for(let i=0;i < ca.length;i++) {
      let c = ca[i];
      while (c.charAt(0)==' ') c = c.substring(1,c.length);
      if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
    }
    return null;
  }
  function showToast(msg) {
    const toast = document.getElementById("toast");
    toast.textContent = msg;
    toast.classList.add("show");
    setTimeout(() => toast.classList.remove("show"), 3000);
  }
</script>

</body>
</html>
