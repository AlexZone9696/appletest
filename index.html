<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Заработок на рекламе — Monetag</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>

  <!-- Monetag SDK -->
  <script src="https://a.monetag.com/tma/sdk.js"
          data-zone="9687002"
          data-sdk="show_9687002"></script>

  <style>
    body { font-family: sans-serif; background: #f5f7fa; padding: 20px; }
    .container {
      max-width: 480px;
      margin: auto;
      background: #fff;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 6px 20px rgba(0,0,0,0.05);
      text-align: center;
    }
    h1 { font-size: 1.4rem; margin-bottom: 15px; }
    button {
      background: #1f8ef1;
      color: #fff;
      padding: 12px 20px;
      border: none;
      border-radius: 8px;
      font-size: 1rem;
      cursor: pointer;
    }
    button:disabled {
      background: #999;
      cursor: not-allowed;
    }
    #status { margin-top: 15px; color: #555; font-size: 0.95rem; }
  </style>
</head>
<body>
<div class="container">
  <h1>Смотри рекламу — зарабатывай</h1>
  <button id="watch" disabled>Загрузка рекламы...</button>
  <div id="status"></div>
</div>

<script>
  const tg = window.Telegram?.WebApp;
  if (tg) tg.expand();

  const watchBtn = document.getElementById('watch');
  const statusEl = document.getElementById('status');

  // Ждём, пока SDK загрузит show_9687002
  const sdkCheck = setInterval(() => {
    if (typeof window.show_9687002 === 'function') {
      clearInterval(sdkCheck);
      watchBtn.disabled = false;
      watchBtn.textContent = '▶ Смотреть рекламу';
    }
  }, 300);

  watchBtn.addEventListener('click', () => {
    statusEl.textContent = 'Загружаем рекламу...';

    show_9687002()
      .then(result => {
        console.log(result);
        if (result && result.reward_event_type === 'valued') {
          statusEl.textContent = 'Реклама просмотрена! Награда получена.';
        } else {
          statusEl.textContent = 'Реклама показана, но без награды.';
        }
      })
      .catch(err => {
        console.error(err);
        statusEl.textContent = 'Ошибка показа рекламы: ' + err.message;
      });
  });
</script>
</body>
</html>
